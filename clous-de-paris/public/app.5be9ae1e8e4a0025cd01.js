!function(t){var e={};function i(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(o,s,function(e){return t[e]}.bind(null,s));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){},function(t,e,i){"use strict";i.r(e);i(0);var o=function(t){return THREE.MathUtils.degToRad(t)},s=function(t,e,i,o){return Math.pow(t-i,2)+Math.pow(e-o,2)},n=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16)/255,g:parseInt(e[2],16)/255,b:parseInt(e[3],16)/255}:null},r=function(t,e,i){return{x:e+e*i,y:0,z:t+t*i}};var a=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.geom=new THREE.ConeBufferGeometry(.4,.6,4),this.rotationX=0,this.rotationY=o(45),this.rotationZ=0};function h(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,c;return e=t,(i=[{key:"setup",value:function(){var t=this;this.gui=new dat.GUI,this.ortho=!0,this.colors={bg:"#000000",mesh:"#ffffff",rect:"#004f24",ambient:"#225b60",spot:"#ffffff"},this.smoothTime=.8,this.raycaster=new THREE.Raycaster,this.gutter={size:-.1},this.meshes=[],this.meshPositions=[],this.grid={cols:120,rows:60},this.width=window.innerWidth,this.height=window.innerHeight,this.mouse3D=new THREE.Vector2,this.repulsion=1,this.geometry=new a,this.gui.addFolder("Background").addColor(this.colors,"bg").onChange((function(e){document.body.style.backgroundColor=e,t.renderer.setClearColor(e)})),window.addEventListener("resize",this.onResize.bind(this),{passive:!0}),window.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0}),this.onMouseMove({clientX:0,clientY:0})}},{key:"createScene",value:function(){this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.renderer.setClearColor(this.colors.bg),document.body.appendChild(this.renderer.domElement)}},{key:"createCamera",value:function(){var t=window.innerWidth,e=window.innerHeight;this.camera=this.ortho?new THREE.OrthographicCamera(t/-2,t/2,e/2,e/-2,1,1e3):this.camera=new THREE.PerspectiveCamera(45,t/e,1),this.camera.position.set(0,30,0),this.camera.zoom=this.ortho?20:1,this.scene.add(this.camera)}},{key:"addAmbientLight",value:function(){var t=new THREE.AmbientLight(this.colors.ambient,1),e=this.createPointLight(this.colors.ambient,{x:-40,y:10,z:-30}),i=this.createPointLight(this.colors.ambient,{x:40,y:10,z:30});this.scene.add(t),this.scene.add(e),this.scene.add(i),this.gui.addFolder("Ambient Light").addColor(this.colors,"ambient").onChange((function(o){t.color=n(o),e.color=n(o),i.color=n(o)}))}},{key:"addSpotLight",value:function(){var t=this;this.spotLight=new THREE.SpotLight(this.colors.spot),this.spotLight.position.set(0,27,0),this.spotLight.castShadow=!0,this.spotLight.shadow.mapSize.width=2048,this.spotLight.shadow.mapSize.height=2048,this.spotLight.shadow.camera.near=this.camera.near,this.spotLight.shadow.camera.far=this.camera.far,this.spotLight.angle=o(20),this.spotLight.penumbra=.5,this.spotLight.intensity=2,this.spotLight.decay=0,this.spotLight.distance=1e3,this.spotLight.target.position.set(0,0,0),this.scene.add(this.spotLight),this.scene.add(this.spotLight.target),this.gui.addFolder("Spot Light").addColor(this.colors,"spot").onChange((function(e){t.spotLight.color=n(e)}))}},{key:"addRectLight",value:function(){var t=new THREE.RectAreaLight(this.colors.rect,1,2e3,2e3);t.position.set(5,50,50),t.lookAt(0,0,0),this.scene.add(t),this.gui.addFolder("Rect Light").addColor(this.colors,"rect").onChange((function(e){t.color=n(e)}))}},{key:"createPointLight",value:function(t,e){var i=new THREE.PointLight(t,1,1e3,1);return i.position.set(e.x,e.y,e.z),i.distance=1e3,i}},{key:"createGrid",value:function(){this.groupMesh=new THREE.Object3D;var t={color:this.colors.mesh,metalness:.7,emissive:"#000",roughness:.2},e=new THREE.MeshPhysicalMaterial(t),i=this.gui.addFolder("Mesh Material");i.addColor(t,"color").onChange((function(t){e.color=n(t)})),i.add(t,"metalness",.1,1).onChange((function(t){e.metalness=t})),i.add(t,"roughness",.1,1).onChange((function(t){e.roughness=t}));for(var o=0;o<this.grid.rows;o++){this.meshes[o]=[],this.meshPositions[o]=[];for(var s=0;s<this.grid.cols;s++){var a=this.getMesh(this.geometry.geom,e),h=r(o,s,this.gutter.size);a.geometry.computeBoundingBox(),a.geometry.center(),a.position.set(h),a.rotation.x=this.geometry.rotationX,a.rotation.y=this.geometry.rotationY,a.rotation.z=this.geometry.rotationZ,a.initialRotation={x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},this.groupMesh.add(a),this.meshes[o][s]=a,this.meshPositions[o][s]=h}}var c=.5*(this.grid.cols-1+(this.grid.cols-1)*this.gutter.size),d=.5*(this.grid.rows-1+(this.grid.rows-1)*this.gutter.size);this.groupMesh.position.set(-c,0,-d),this.scene.add(this.groupMesh)}},{key:"getMesh",value:function(t,e){var i=new THREE.Mesh(t,e);return i.castShadow=!0,i.receiveShadow=!0,i}},{key:"addCameraControls",value:function(){this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement)}},{key:"addFloor",value:function(){var t=new THREE.PlaneGeometry(2e3,2e3),e=new THREE.ShadowMaterial({opacity:.3});this.floor=new THREE.Mesh(t,e),this.floor.position.y=0,this.floor.rotateX(-Math.PI/2),this.floor.receiveShadow=!0,this.scene.add(this.floor)}},{key:"init",value:function(){this.setup(),this.createScene(),this.createCamera(),this.addAmbientLight(),this.addSpotLight(),this.addRectLight(),this.createGrid(),this.addCameraControls(),this.addFloor(),this.animate()}},{key:"onMouseMove",value:function(t){var e=t.clientX,i=t.clientY;this.mouse3D.x=e/this.width*2-1,this.mouse3D.y=-i/this.height*2+1}},{key:"onResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}},{key:"draw",value:function(){this.raycaster.setFromCamera(this.mouse3D,this.camera);var t=this.raycaster.intersectObjects([this.floor]);if(t.length){var e={x:t[0].point.x,y:0,z:t[0].point.z},i={x:t[0].point.x,y:this.spotLight.position.y,z:t[0].point.z};TweenMax.to(this.spotLight.position,this.smoothTime,i),TweenMax.to(this.spotLight.target.position,this.smoothTime,e);for(var o=new THREE.Vector3,n=0;n<this.grid.rows;n++)for(var r=0;r<this.grid.cols;r++){var a=this.meshes[n][r],h=this.meshPositions[n][r],c={x:h.x+this.groupMesh.position.x,y:h.y,z:h.z+this.groupMesh.position.z};o.subVectors(c,e).normalize();var d=s(e.x,e.z,c.x,c.z),u=THREE.MathUtils.clamp(1-Math.abs(d)/40,0,1),l=1-u,g={x:h.x-o.x*l,y:h.y+u,z:h.z-o.z*l};TweenMax.to(a.position,this.smoothTime,g),TweenMax.to(a.scale,this.smoothTime,{x:1+.4*u,y:1+2*u,z:1+.4*u})}}}},{key:"animate",value:function(){this.controls.update(),this.draw(),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.animate.bind(this))}}])&&h(e.prototype,i),c&&h(e,c),t}())).init()}]);